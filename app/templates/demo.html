<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title> –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è </title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0f172a;
            color: #e2e8f0;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        .container { background: #1e293b; padding: 20px; border-radius: 12px; }
        h1 { color: #8b5cf6; text-align: center; }
        .pipeline {
            display: flex;
            flex-direction: column;
            gap: 25px;
            margin: 30px 0;
        }
        .stage {
            background: #334155;
            padding: 20px;
            border-radius: 10px;
            position: relative;
        }
        .stage::before {
            content: "‚Üí";
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            color: #94a3b8;
            font-size: 24px;
        }
        .stage:last-child::before {
            display: none;
        }
        .stage-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
            color: #c4b5fd;
        }
        .stage-title::before {
            content: "‚óè";
            color: #8b5cf6;
        }
        .data {
            font-family: monospace;
            background: #0f172a;
            padding: 12px;
            border-radius: 6px;
            word-break: break-all;
            font-size: 14px;
        }
        .explanation {
            margin-top: 10px;
            color: #94a3b8;
            font-style: italic;
        }
        button {
            background: #8b5cf6;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 18px;
            border-radius: 8px;
            cursor: pointer;
            display: block;
            margin: 20px auto;
        }
        button:disabled {
            background: #94a3b8;
            cursor: not-allowed;
        }
        .status { text-align: center; margin: 15px; color: #fbbf24; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéì –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã</h1>
        <p>–≠—Ç–æ—Ç —Ä–µ–∂–∏–º –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ —Å—ã—Ä–∞—è —ç–Ω—Ç—Ä–æ–ø–∏—è –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –∫—Ä–∏–ø—Ç–æ—Å—Ç–æ–π–∫–æ–µ —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ.</p>

        <button id="demoBtn" onclick="runDemo()">–ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é</button>
        <div class="status" id="status"></div>

        <div class="pipeline" id="pipeline" style="display:none;">
            <div class="stage">
                <div class="stage-title">–°—ã—Ä–∞—è —ç–Ω—Ç—Ä–æ–ø–∏—è (–∏–º–∏—Ç–∞—Ü–∏—è)</div>
                <div class="data" id="raw"></div>
                <div class="explanation" id="exp1"></div>
            </div>
            <div class="stage">
                <div class="stage-title">Chaotic Map (Logistic)</div>
                <div class="data" id="chaotic"></div>
                <div class="explanation" id="exp2"></div>
            </div>
            <div class="stage">
                <div class="stage-title">Cellular Automaton (Rule 30)</div>
                <div class="data" id="ca"></div>
                <div class="explanation" id="exp3"></div>
            </div>
            <div class="stage">
                <div class="stage-title">SHA3-256 Whitening</div>
                <div class="data" id="hash"></div>
                <div class="explanation" id="exp4"></div>
            </div>
            <div class="stage">
                <div class="stage-title">–§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–µ–º—è (HKDF)</div>
                <div class="data" id="final"></div>
                <div class="explanation" id="exp5"></div>
            </div>
        </div>
    </div>

    <script>
        async function runDemo() {
            const btn = document.getElementById('demoBtn');
            const status = document.getElementById('status');
            const pipeline = document.getElementById('pipeline');

            btn.disabled = true;
            status.textContent = "–ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏...";
            pipeline.style.display = 'none';

            try {
                const res = await fetch('/demo/generate');
                const data = await res.json();

                document.getElementById('raw').textContent = data.raw_entropy_sample;
                document.getElementById('chaotic').textContent = data.after_chaotic;
                document.getElementById('ca').textContent = data.after_ca;
                document.getElementById('hash').textContent = data.after_hash;
                document.getElementById('final').textContent = data.final_seed;

                const exp = data.explanations;
                document.getElementById('exp1').textContent = "–ò–º–∏—Ç–∞—Ü–∏—è —Å–±–æ—Ä–∞ —ç–Ω—Ç—Ä–æ–ø–∏–∏ –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞ (–Ω–∞ –æ—Å–Ω–æ–≤–µ os.urandom).";
                document.getElementById('exp2').textContent = exp.chaotic;
                document.getElementById('exp3').textContent = exp.ca;
                document.getElementById('exp4').textContent = exp.hash;
                document.getElementById('exp5').textContent = exp.hkdf;

                pipeline.style.display = 'flex';
                status.textContent = "–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!";
                status.style.color = "#34d399";

            } catch (e) {
                status.textContent = "–û—à–∏–±–∫–∞: " + e.message;
                status.className = "status error";
            } finally {
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>